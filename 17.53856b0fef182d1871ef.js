(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{MufC:function(t,o,e){"use strict";e.r(o),e.d(o,"YmapModule",function(){return O});var a=e("ofXK"),n=e("tyNb");const r=30;var l=e("fXoL"),i=e("mrSG");const c=t=>{const o=[{nodeArray:[t]}];return s(t.childs,o),(t=>{const o=Math.floor(330/t.length-r);t.forEach((t,e)=>{const a=Math.floor(330/t.nodeArray.length-r);t.nodeArray.forEach((t,n)=>{t.layout={top:(o+r)*e+1,bottom:(o+r)*e+o,left:(a+r)*n+1,right:(a+r)*n+a},t.middle={x:Math.floor((t.layout.left+t.layout.right)/2),y:Math.floor((t.layout.top+t.layout.bottom)/2)},t.layout.right-t.layout.left>200&&(t.layout.right=t.middle.x+100,t.layout.left=t.middle.x-100),t.layout.bottom-t.layout.top>200&&(t.layout.bottom=t.middle.y+100,t.layout.top=t.middle.y-100)})});const e=[];return t.forEach(t=>t.nodeArray.forEach(t=>(t.lines=[])&&t.childs.forEach(o=>{t.lines.push(...((t,o,e,a,n,r)=>{const l=n[r];let i=Math.floor((o+a)/2);if(l)for(let c=0;l[c];c++){const o=l[c];if(!(o.start>=Math.max(t,e)||o.end<=Math.min(t,e))){i+=Math.floor(1);break}}else n[r]=[{start:Math.min(t,e),end:Math.max(t,e)}];return[{x_1:t,y_1:o,x_2:t,y_2:i},{x_1:t,y_1:i,x_2:e,y_2:i},{x_1:e,y_1:i,x_2:e,y_2:a}]})(t.middle.x,t.layout.bottom,o.middle.x,o.layout.top,e,t.layer))}))),console.log(e),{items:t}})(o)},s=(t,o)=>{t.forEach(t=>{o[t.layer]?o[t.layer].nodeArray.push(t):o[t.layer]={nodeArray:[t]},s(t.childs,o)})};var d=e("FjO5");let y=(()=>{let t=class{constructor(){this.state={mapNode:{type:"square",childs:[{type:"square",childs:[],layer:1,name:"Root_child_1",lines:[]},{type:"square",childs:[],layer:1,name:"Root_child_2",lines:[]}],layer:0,name:"Root",lines:[]},ymap:{items:[]}},this.state.ymap=c(this.state.mapNode)}addNode(t,o,e){const a=this.getNode(t,o);a.childs.push({type:"test",name:a.name+"_child_"+(a.childs.length+1),childs:[],layer:a.layer+1,lines:[]}),this.update()}update(){this.ymap=c(this.state.mapNode)}getNode(t,o){return this.state.ymap.items[t].nodeArray[o]}get ymap(){return this.state.ymap}set ymap(t){this.state.ymap=t}};return t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=l.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(i.a)([Object(d.a)({log:"add node"})],t.prototype,"addNode",null),Object(i.a)([Object(d.a)()],t.prototype,"update",null),t=Object(i.a)([Object(d.c)({name:"ymap test"})],t),t})();var u=e("OzZK"),m=e("RwU8"),p=e("C2AL");function h(t,o){if(1&t){const t=l.Ub();l.Tb(0,"div",4),l.Tb(1,"span",5),l.ac("click",function(){l.qc(t);const e=o.index,a=l.dc().index;return l.dc().add(a,e)}),l.Bc(2),l.Sb(),l.Sb()}if(2&t){const t=o.$implicit;l.wc("grid-column-start:"+(null==t.layout?null:t.layout.left)+";grid-column-end:"+(null==t.layout?null:t.layout.right)+";grid-row-start:"+(null==t.layout?null:t.layout.top)+";grid-row-end:"+(null==t.layout?null:t.layout.bottom)),l.zb(2),l.Dc(" ",t.name," ")}}function f(t,o){if(1&t&&(l.Rb(0),l.zc(1,h,3,3,"div",3),l.Qb()),2&t){const t=o.$implicit;l.zb(1),l.jc("ngForOf",t.nodeArray)}}function b(t,o){if(1&t&&l.Ob(0,"div",7),2&t){const t=o.$implicit;l.wc("grid-column-start:"+t.x_1+";grid-row-start:"+t.y_1+";grid-column-end:"+(t.x_2+1)+";grid-row-end:"+(t.y_2+1))}}function g(t,o){if(1&t&&(l.Rb(0),l.zc(1,b,1,2,"div",6),l.Qb()),2&t){const t=o.$implicit;l.zb(1),l.jc("ngForOf",t.lines)}}function x(t,o){if(1&t&&(l.Rb(0),l.zc(1,g,2,1,"ng-container",2),l.Qb()),2&t){const t=o.$implicit;l.zb(1),l.jc("ngForOf",t.nodeArray)}}const w=[{path:"",component:(()=>{class t{constructor(t){this.ymapModule=t}ngOnInit(){console.log(this.ymapModule.state)}add(t,o){console.log("Add layer: "+t+", index:"+o),this.ymapModule.addNode(t,o,{type:"test",name:"add Test"})}clear(){this.ymapModule.state.mapNode={type:"square",childs:[],layer:0,name:"Root",lines:[]},this.ymapModule.update()}get layout(){return{maxRow:300,maxCol:300}}}return t.\u0275fac=function(o){return new(o||t)(l.Nb(y))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-ymap"]],decls:8,vars:4,consts:[["nz-button","","nzType","primary",3,"click"],[1,"ymap-container"],[4,"ngFor","ngForOf"],["class","ymap-container-item",3,"style",4,"ngFor","ngForOf"],[1,"ymap-container-item"],[3,"click"],["class","ymap-container-line",3,"style",4,"ngFor","ngForOf"],[1,"ymap-container-line"]],template:function(t,o){1&t&&(l.Tb(0,"div"),l.Tb(1,"p"),l.Bc(2,"ymap works!"),l.Sb(),l.Tb(3,"button",0),l.ac("click",function(){return o.clear()}),l.Bc(4,"Clear"),l.Sb(),l.Sb(),l.Tb(5,"div",1),l.zc(6,f,2,1,"ng-container",2),l.zc(7,x,2,1,"ng-container",2),l.Sb()),2&t&&(l.zb(5),l.wc("grid-template-column: repeat("+o.layout.maxCol+", "+100/o.layout.maxCol+"%);grid-template-rows: repeat("+o.layout.maxRow+", "+100/o.layout.maxRow+"%);"),l.zb(1),l.jc("ngForOf",o.ymapModule.ymap.items),l.zb(1),l.jc("ngForOf",o.ymapModule.ymap.items))},directives:[u.a,m.a,p.a,a.m],styles:[".ymap-container[_ngcontent-%COMP%]{float:left;width:1400px;height:1000px;display:grid}.ymap-container-item[_ngcontent-%COMP%]{background-color:#6495ed;overflow:hidden}.ymap-container-line[_ngcontent-%COMP%]{background-color:#555}"]}),t})()}];let _=(()=>{class t{}return t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({factory:function(o){return new(o||t)},imports:[[n.e.forChild(w)],n.e]}),t})();var M=e("B+r4");let O=(()=>{class t{}return t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({factory:function(o){return new(o||t)},imports:[[a.c,_,u.c,M.b]]}),t})()}}]);